# Values for {{ project_name }} — {{ environment }} environment
# Generated by ninja-deploy
#
# IMPORTANT: Set image.tag to a specific version before deploying.
# All database credentials MUST be replaced with real secrets or
# managed via an external secret store (e.g., ExternalSecret CRD).

replicaCount: {{ profile.replicas }}

image:
  repository: {{ project_name }}
  pullPolicy: IfNotPresent
  # tag must be explicitly set — "latest" is not allowed in production.
  tag: "{{ '{{ .Release.Name }}-{{ .Release.Revision }}' }}"

resources:
  requests:
    cpu: {{ profile.cpu_request }}
    memory: {{ profile.memory_request }}
  limits:
    cpu: {{ profile.cpu_limit }}
    memory: {{ profile.memory_limit }}

service:
  type: ClusterIP
  port: 8000

{% if StorageEngine.SQL in engines %}
postgresql:
  enabled: true
  auth:
    # Replace with a real password or use existingSecret / ExternalSecret.
    postgresPassword: "${POSTGRES_PASSWORD}"
    database: "{{ project_name | replace('-', '_') }}"
  primary:
    persistence:
      size: 8Gi
{% endif %}

{% if StorageEngine.MONGO in engines %}
mongodb:
  enabled: true
  auth:
    # Replace with a real password or use existingSecret / ExternalSecret.
    rootPassword: "${MONGO_ROOT_PASSWORD}"
    database: "{{ project_name | replace('-', '_') }}"
  persistence:
    size: 8Gi
{% endif %}

{% if StorageEngine.GRAPH in engines %}
neo4j:
  enabled: true
  neo4j:
    # Replace with a real password or use existingSecret / ExternalSecret.
    password: "${NEO4J_PASSWORD}"
  volumes:
    data:
      mode: defaultStorageClass
      defaultStorageClass:
        requests:
          storage: 8Gi
{% endif %}

{% if StorageEngine.VECTOR in engines %}
milvus:
  enabled: true
  standalone:
    resources:
      requests:
        cpu: 200m
        memory: 256Mi
{% endif %}
